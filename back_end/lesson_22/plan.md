# Lesson plan No.22 02/13/2024


================================================================

# План занятия №22 13.02.2024:

## Что мы сделали на прошлом занятии:

Разработали приложение Fitlio
    - создали приложение, в котором есть две сущности(entity):
      - users(пользователи):
        - User: id, name, email, password, role, 
        - UserProfile: id(?), firstName, lastName, gender, dateOfBirth, weight, height, allowance
      - events(события), например, любительские тренировки и занятия спортом:
        - Fitlio: id, title, description, timeMinute, timeHour, date, calorie, distance, type: GENERAL, POWER, CARDIO, GAME, CALORIE, STAMINA
    - делаем реализацию такого приложения с учетом:
        - `Object Relational Mapping`/`ORM` - см. раздел теория;
        - всех полученных ранее знаний по созданию проекта, принципов и подходов SOLID-архитектуры, необходимых аннотаций и правил написания REST API;
        - пишем функциональные и интеграционные тесты.
      - **слой DTO**
        - UserDto - OK
        - NewUserDto - OK
        - FitlioDto - OK
        - NewFitlioDto - OK 
      - **"соединить" User и User~~Dto~~Profile** (связь между таблицами) - OK
      - слой сервисов
      - контроллеры
        - добавить занятие (fitlio)
        - получить список имеющихся занятий
       -------------------------------------------------
1. Работали с приложением:
    - **сделали файл с запросами**:
        - POST - это отправить данные о тренировке (объект типа Fitlio) на сервер
        - GET - получить список тренировок (List<Fitlio>)
        - протестировать "вручную" работу api
    - делали запросы из Swagger
    - разбирались с validation и аннотациями для Swagger

## План на сегодняшнее занятие:

### Настройка безопасности Spring Boot с Spring Security

* При подключении Spring Boot Starter Security появляется:
    * Страница входа;
    * Защита всех endpoints;
    * Логин `user;
    * Пароль генерируется в консоли;
* Но мы хотим, чтобы люди заходили под своими логинами и паролями.

### Шаги по настройке Spring Security

1. Создать класс-реализацию интерфейса `UserDetails`
* Данный класс нужен для того, чтобы адаптировать пользователя под безопасность Spring Security
* По сути, это адаптер нашего класса `User` для `Spring Security`
* В нашем случае это класс `AuthenticatedUser`
2. Создать класс-реализацию интерфейса `UserDetailsService`
* Данный класс нужен для того, чтобы показать Spring Security откуда брать пользователя для проверки
* В нашем случае это класс `UserDetailsServiceImpl`
3. Настройка конфигурации Spring Security (см. комментарии в коде)
4. Проверить работу endpoints







    







